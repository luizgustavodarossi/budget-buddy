<div class="d-flex justify-content-between py-3">
  <h2><%= @transactions.model_name.human.pluralize %></h2>

  <div class="d-flex align-self-center gap-1">
    <div class="btn-group">
      <%= link_to new_transaction_path(kind: 'income', accountable_type: 'Account'), title: "New income", class: 'btn btn-primary' do %>
        <i class="bi bi-plus"></i>
        Income
      <% end %>
      <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
        <span class="visually-hidden">Toggle Dropdown</span>
      </button>
      <ul class="dropdown-menu">
        <li>
          <%= link_to new_transaction_path(kind: 'income', accountable_type: 'CreditCard'), title: "New income on credit card", class: 'dropdown-item' do %>
            Income on credit card
          <% end %>
        </li>
      </ul>
    </div>

    <div class="btn-group">
      <%= link_to new_transaction_path(kind: 'expense', accountable_type: 'Account'), title: "New expense", class: 'btn btn-primary' do %>
        <i class="bi bi-plus"></i>
        Expense
      <% end %>
      <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
        <span class="visually-hidden">Toggle Dropdown</span>
      </button>
      <ul class="dropdown-menu">
        <li>
          <%= link_to new_transaction_path(kind: 'expense', accountable_type: 'CreditCard'), title: "New expense on credit card", class: 'dropdown-item' do %>
            Expense on credit card
          <% end %>
        </li>
      </ul>
    </div>

    <%= link_to new_transaction_path(kind: 'transfer'), title: "New transfer", class: 'btn btn-primary' do %>
      <i class="bi bi-plus"></i>
      Transfer
    <% end %>

     <div class="dropdown">
      <button class="btn btn-secondary" data-bs-toggle="dropdown">
        <i class="bi bi-three-dots-vertical"></i>
      </button>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item disabled"><i class="bi bi-lock"></i> Import</a></li>
        <li><a class="dropdown-item disabled"><i class="bi bi-lock"></i> Export</a></li>
      </ul>
    </div>
  </div>
</div>

<div class="row justify-content-end mb-4">
  <div class="col">
    <%== pagy_info(@pagy) %>
  </div>  
  <div class="col-md-4">
    <%= form_with method: :get, url: transactions_path, class: "form-inline" do |f| %>
      <div class="d-flex ">
        <%= f.text_field :search, value: params[:search], class: "form-control mx-2", placeholder: "Search..." %>
        <%= f.submit "Search", name: nil, class: "btn btn-outline-secondary" %>
      </div>
    <% end %>
  </div>
</div>

<% if @transactions.empty? %>
  <div class="alert alert-info" role="alert">
    No <%= @transactions.model_name.human.pluralize %> found.
  </div>
<% else %>
  <div class="row">
    <table class="table table-striped">
      <thead class="table-bordered">
        <tr>
          <th>Description</th>
          <th>Kind</th>
          <th class="text-center" style="width: 200px;">Actions</th>
        </tr>
      </thead>
      <tbody class="table-group-divider">
        <% @transactions.each do |transaction| %>
          <tr>
            <td><%= transaction.description %></td>
            <td>
              <% badge_class = {
                  'income' => 'success',
                  'expense' => 'danger',
                  'transfer' => 'warning'
              }.fetch(transaction.kind.to_s, 'info') %>
              <span class="badge text-bg-<%= badge_class %>"><%= transaction.kind.humanize %></span>
            </td>
            <td class="d-flex justify-content-center gap-1">
              <%= link_to transaction, title: "Show", class: "btn btn-sm btn-info" do %>
                <i class="bi bi-eye"></i>
              <% end %>
              
              <%= link_to edit_transaction_path(transaction), title: "Edit", class: "btn btn-sm btn-primary" do %>
                <i class="bi bi-pencil"></i>
              <% end %>

              <%= link_to url_for(action: :destroy, id: transaction.id), 
                          data: {turbo_method: :delete, turbo_confirm: 'Are you sure?'}, 
                          title: "Delete", 
                          class: "btn btn-sm btn-danger" do %>
                <i class="bi bi-trash"></i>
              <% end %>

              <div class="dropdown">
                <button class="btn btn-sm btn-secondary" data-bs-toggle="dropdown">
                  <i class="bi bi-three-dots-vertical"></i>
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item disabled"><i class="bi bi-lock"></i> Clone</a></li>
                </ul>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="row">
    <nav class="d-flex justify-content-center">
      <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
    </nav>
  </div>
<% end %>

